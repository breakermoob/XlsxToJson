<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <meta http-equiv="X-UA-Compatible" content="ie=edge">
   <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.14.3/xlsx.full.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
   <!-- Compiled and minified CSS -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
   <!-- Compiled and minified JavaScript -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
   <title>Importar XLSX</title>
</head>

<body>

   <div class="row">
      <div class="col s12">
         <h1 class="center-align">
            Prueba de tabla Cargada desde JSON
         </h1>
      </div>
   </div>
   <div class="row">
      <div class="col s3"></div>
      <div class="col s6">
         <table class="highlight responsive-table">
            <thead>
               <th>Codigo</th>
               <th>Curso</th>
            </thead>
            <tbody id="tablaCursos">
            </tbody>
         </table>
      </div>
      <div class="col s3"></div>
   </div>
   <script>
      /*Leon Arango 2019*/
      var cursos;

      $(document).ready(function () {
         /* Se importa el archivo con un XMLHttpRequest */
         var url = "xlsx/cursos.xlsx";
         var oReq = new XMLHttpRequest();
         oReq.open("GET", url, true);
         oReq.responseType = "arraybuffer";

         oReq.onload = function (e) {
            var arraybuffer = oReq.response;

            /* Convertir Datos en un String binario*/
            var data = new Uint8Array(arraybuffer);
            var arr = new Array();
            for (var i = 0; i != data.length; ++i) arr[i] = String.fromCharCode(data[i]);
            var bstr = arr.join("");

            /* Llamar el archivo*/
            var workbook = XLSX.read(bstr, { type: "binary" });

            /* DO SOMETHING WITH workbook HERE */
            var first_sheet_name = workbook.SheetNames[0];

            /* Get worksheet */
            var worksheet = workbook.Sheets[first_sheet_name];
            cursos = (XLSX.utils.sheet_to_json(worksheet, { raw: true }));
            console.log(cursos)

            /*Llenar la tabla con los cursos*/
            for (var i = 0; i < cursos.length; i++) {
               var tr = `<tr>
         <td>`+ cursos[i].codigo + `</td>
         <td>`+ cursos[i].curso + `</td>
       </tr>`;
               $("#tablaCursos").append(tr)
            }
         }
         oReq.send()
      });
   </script>
</body>

</html>